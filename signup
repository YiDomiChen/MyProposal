<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <script src="https://www.gstatic.com/firebasejs/4.5.0/firebase.js"></script>
  <script src="https://www.gstatic.com/firebasejs/4.2.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/4.2.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/4.2.0/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/4.2.0/firebase-messaging.js"></script>
 
  
  
  <!--<link href="https://fonts.googleapis.com/css?family=Roboto:300,500" rel="stylesheet"> -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  
<style>
body {
    background:#eee;
    margin:0;
    padding:0;
}
.example {
    background:#fff url(../images/tech.jpg);
    /*width:750px;
    height:570px;
    border:1px #000 solid;*/
    margin:20px auto;
    padding:15px;
    border-radius:3px;
    -moz-border-radius:3px;
    -webkit-border-radius:3px;
}

/* main menu styles */
#nav,#nav ul {
    background-image:url(../images/tr75.png);
    list-style:none;
    margin:0;
    padding:0;
}
#nav {
    height:41px;
    padding-left:5px;
    padding-top:5px;
    position:relative;
    z-index:2;
}
#nav ul {
    left:-9999px;
    position:absolute;
    top:37px;
    width:auto;
}
#nav ul ul {
    left:-9999px;
    position:absolute;
    top:0;
    width:auto;
}
#nav li {
    float:left;
    margin-right:5px;
    position:relative;
}
#nav li a {
	
    background:#c1c1bf;
    color:#000;
    display:block;
    float:left;
    font-size:16px;
    padding:8px 10px;
    text-decoration:none;
}
#nav > li > a {
    -moz-border-radius:6px;
    -webkit-border-radius:6px;
    -o-border-radius:6px;
    border-radius:6px;

    overflow:hidden;
}
#nav li a.fly {
	margin:0 auto; 
    background:#c1c1bf url(../images/arrow.gif) no-repeat right center;
    padding-right:15px;
}
#nav ul li {
    margin:0;
}
#nav ul li a {
    width:120px;
}
#nav ul li a.fly {
    padding-right:10px;
}

/*hover styles*/
#nav li:hover > a {
	
    background-color:#858180;
    color:#fff;
}

/*focus styles*/
    #nav li a:focus {
    outline-width:0;
}

/*popups*/
#nav li a:active + ul.dd,#nav li a:focus + ul.dd,#nav li ul.dd:hover {
    left:0;
}
#nav ul.dd li a:active + ul,#nav ul.dd li a:focus + ul,#nav ul.dd li ul:hover {
    left:140px;
}

.container{
	position: relative;
	width: 90%;
}

body, div, dl, dt, dd, ul, ol, li, h1, h2, h3, h4, h5, h6, 
pre, form, fieldset, input, textarea, p, blockquote, th, td { 
  padding:0;
  margin:0;}

fieldset, img {border:0}

ol, ul, li {list-style:none}

:focus {outline:none}

body,
input,
textarea,
select {
  font-family: 'Open Sans', sans-serif;
  font-size: 16px;
  color: #4c4c4c;
}

p {
  font-size: 12px;
  width: 150px;
  display: inline-block;
  margin-left: 18px;
}
h1 {
  font-size: 32px;
  font-weight: 300;
  color: #4c4c4c;
  text-align: center;
  padding-top: 10px;
  margin-bottom: 10px;
}

html{
  background-color: #ffffff;
}

.testbox {
  margin: 20px auto;
  width: 343px; 
  height: 464px; 
  -webkit-border-radius: 8px/7px; 
  -moz-border-radius: 8px/7px; 
  border-radius: 8px/7px; 
  background-color: #ebebeb; 
  -webkit-box-shadow: 1px 2px 5px rgba(0,0,0,.31); 
  -moz-box-shadow: 1px 2px 5px rgba(0,0,0,.31); 
  box-shadow: 1px 2px 5px rgba(0,0,0,.31); 
  border: solid 1px #cbc9c9;
}

input[type=radio] {
  visibility: hidden;
}

form{
  margin: 0 30px;
}

label.radio {
	cursor: pointer;
  text-indent: 35px;
  overflow: visible;
  display: inline-block;
  position: relative;
  margin-bottom: 15px;
}

label.radio:before {
  background: #3a57af;
  content:'';
  position: absolute;
  top:2px;
  left: 0;
  width: 20px;
  height: 20px;
  border-radius: 100%;
}

label.radio:after {
	opacity: 0;
	content: '';
	position: absolute;
	width: 0.5em;
	height: 0.25em;
	background: transparent;
	top: 7.5px;
	left: 4.5px;
	border: 3px solid #ffffff;
	border-top: none;
	border-right: none;

	-webkit-transform: rotate(-45deg);
	-moz-transform: rotate(-45deg);
	-o-transform: rotate(-45deg);
	-ms-transform: rotate(-45deg);
	transform: rotate(-45deg);
}

input[type=radio]:checked + label:after {
	opacity: 1;
}

hr{
  color: #a9a9a9;
  opacity: 0.3;
}

input[type=text],input[type=password]{
  width: 200px; 
  height: 39px; 
  -webkit-border-radius: 0px 4px 4px 0px/5px 5px 4px 4px; 
  -moz-border-radius: 0px 4px 4px 0px/0px 0px 4px 4px; 
  border-radius: 0px 4px 4px 0px/5px 5px 4px 4px; 
  background-color: #fff; 
  -webkit-box-shadow: 1px 2px 5px rgba(0,0,0,.09); 
  -moz-box-shadow: 1px 2px 5px rgba(0,0,0,.09); 
  box-shadow: 1px 2px 5px rgba(0,0,0,.09); 
  border: solid 1px #cbc9c9;
  margin-left: -5px;
  margin-top: 13px; 
  padding-left: 10px;
}

input[type=password]{
  margin-bottom: 25px;
}

#icon {
  display: inline-block;
  width: 100px;
  background-color: #3a57af;
  padding: 8px 0px 8px 15px;
  margin-left: 15px;
  -webkit-border-radius: 4px 0px 0px 4px; 
  -moz-border-radius: 4px 0px 0px 4px; 
  border-radius: 4px 0px 0px 4px;
  color: white;
  -webkit-box-shadow: 1px 2px 5px rgba(0,0,0,.09);
  -moz-box-shadow: 1px 2px 5px rgba(0,0,0,.09); 
  box-shadow: 1px 2px 5px rgba(0,0,0,.09); 
  border: solid 0px #cbc9c9;
}

.accounttype{
  margin-left: 8px;
  margin-top: 20px;
}

a.button {
  font-size: 14px;
  font-weight: 600;
  color: white;
  padding: 6px 25px 0px 20px;
  margin: 10px 8px 20px 0px;
  display: inline-block;
  float: right;
  text-decoration: none;
  width: 50px; height: 27px; 
  -webkit-border-radius: 5px; 
  -moz-border-radius: 5px; 
  border-radius: 5px; 
  background-color: #3a57af; 
  -webkit-box-shadow: 0 3px rgba(58,87,175,.75); 
  -moz-box-shadow: 0 3px rgba(58,87,175,.75); 
  box-shadow: 0 3px rgba(58,87,175,.75);
  transition: all 0.1s linear 0s; 
  top: 0px;
  position: relative;
}

a.button:hover {
  top: 3px;
  background-color:#2e458b;
  -webkit-box-shadow: none; 
  -moz-box-shadow: none; 
  box-shadow: none;
  
}
form {
                width:500px;
                margin:left;
}
.search {
                padding:8px 15px;
                background:rgba(50, 50, 50, 0.2);
                border:0px solid #dbdbdb;
}
.button {
                position:relative;
                padding:6px 15px;
                left:-8px;
                border:2px solid #207cca;
                background-color:#BCBCBC;
                color:#fafafa;
}
.button:hover  {
                background-color:#fafafa;
                color:#207cca;
}
</style>  
</head>
<body>
  <h1>Signup Form</h1>
  <div class="container">
  	<label id="icon" for="name"><i class="icon-envelope "><b>Email</b><span class = "front_input"></span></i></label>
   
	<input id="txtEmail" type="text" placeholder="Email"><br>
	<label id="icon" for="name"><i class="icon-envelope "><b>Password</b><span class = "front_input"></span></i></label>
	<input id="txtPassword" type="password" placeholder="Password" onblur = "check_pass()"><span id = "pass_error" class = "after_input"></span><br>

  <label id="icon" for="name"><i class="icon-envelope "><b>Re-enter</b><span class = "front_input"></span></i></label>
  <input id="txtRePassword" type="password" placeholder="Re-enter Password" onblur = "check_rpass()"><span id = "rpass_error" class = "after_input"></span><br>
	
	<button id="btnSignUp" class="btn btn-secondary" onclick = "regist()">
	 Sign up
	</button>
    
	
	<button id="btnLogout" class="btn btn-action hide">
	 Log out
	</button>
  
    </div>
            <div class="container" style = "background-color:#FFF" style="width:90%">
            </div>
  </div>
	
	
   
   <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyCCMcd6IQe1VjhjElv-ExFqOYAdD14S4v0",
      authDomain: "myproposal-be581.firebaseapp.com",
      databaseURL: "https://myproposal-be581.firebaseio.com",
      projectId: "myproposal-be581",
      storageBucket: "myproposal-be581.appspot.com",
      messagingSenderId: "128814836934"
    };
    firebase.initializeApp(config);
	//use for auth
	//Get  elements
	/*const txtEmail =document.getElementById('txtEmail');
	const txtPassword = document.getElementById('txtPassword');
	//const btnLogin = document.getElementById('btnLogin');
	const btnSignUp = document.getElementById('btnSignUp');
	const btnLogout = document.getElementById('btnLogout');
	
	//add login
	/*btnLogin.addEventListener('click', e => {	
  	const email =txtEmail.value;
  	const pass =txtPassword.value;
  	const auth=firebase.auth();
  	//sign in
  	const promise= auth.signInWithEmailAndPassword(email,pass);
  	promise.catch(e => console.log(e.message));
	});*/
	
	//signup
	/*btnSignUp.addEventListener('click', e =>{
    //TODO:check 4 real email
  	const email =txtEmail.value;
    const pass =txtPassword.value;
    const auth=firebase.auth();	
  	//sign in
    const promise= auth.createUserWithEmailAndPassword(email,pass);
    var uid = Math.random().toString(36).substr(2);
    firebase.database().ref("User/" + uid).set({
      email: email,
      password: pass
    });
    promise.catch(e => console.log(e.message));	//.then(user => console.log(user))
	});
	
	btnLogout.addEventListener('click', e => {
		firebase.auth().signOut();
	});
	
	//add a realtime listener
	firebase.auth().onAuthStateChanged(firebaseUser =>{
		if (firebaseUser){
			console.log(firebaseUser);
			btnLogout.classList.remove('hide');
			
			var user = firebase.auth().currentUser;

			user.sendEmailVerification().then(function() {
			// Email sent.
			}).catch(function(error) {
			// An error happened.
			});
			
			
		}else {
			console.log('not logged in');
			btnLogout.classList.add('hide');
		}
	});*/

  var _pass;     
/**      *Check user name        */      
String.prototype.Trim = function() {      
return this.replace(/(^\s*)|(\s*$)/g, ""); }

  /**      *check password    */      //---------------------------------------------------------------------------     
      function check_pass(){      
      var pass;       
      pass = document.getElementById('txtPassword').value;      
      pass = pass.Trim();      
      _pass = pass;      
      if (pass == "") {        
      document.getElementById('pass_error').innerHTML = "Password cannot be null"; 

          } 
      else {         
        if (/^\w{6,20}$/.test(pass)) {          
          document.getElementById('pass_error').innerHTML = "";           } 
        else {          
          document.getElementById('pass_error').innerHTML = "6 ~ 20 character【0-9】【a-z-A-Z】";         
        }             
      }      
    }    

  /**      *check rpass     */      //---------------------------------------------------------------------------     
function check_rpass(){      
  var rpass;       
  rpass = document.getElementById('txtRePassword').value;      
  rpass = rpass.Trim();      
  if (rpass == "") {        
    document.getElementById('rpass_error').innerHTML = "re-enter passwrd cannot be null";       
    }        
    else if (rpass != _pass) {        
      document.getElementById('rpass_error').innerHTML = "Password is different";       
      }      
    else {        
      document.getElementById('rpass_error').innerHTML = ""
    }         
  }  

function regist(){       
        
  var pass_error=document.getElementById('pass_error').innerHTML;    
  var rpass_error=document.getElementById('rpass_error').innerHTML;    
  //var email_error=document.getElementById('email_error').innerHTML;    
       
  var pass=document.getElementById('txtPassword').value;      
  var rpass=document.getElementById('txtRePassword').value;      
  //var email=document.getElementById('email').value;   
  
   if ((pass_error == "" && rpass_error == "" )&&(pass_error != "" && rpass != "" )) {       
    alert ("Congratulation, you have successfully registed!");  
    const txtEmail =document.getElementById('txtEmail');
    const txtPassword = document.getElementById('txtPassword');
    //const btnLogin = document.getElementById('btnLogin');
    const btnSignUp = document.getElementById('btnSignUp');
    const btnLogout = document.getElementById('btnLogout');

    //signup
    btnSignUp.addEventListener('click', e =>{
    //TODO:check 4 real email
    const email =txtEmail.value;
    const pass =txtPassword.value;
    const auth=firebase.auth(); 
    //sign in
    const promise= auth.createUserWithEmailAndPassword(email,pass);
    var uid = Math.random().toString(36).substr(2);
    firebase.database().ref("User/" + uid).set({
      email: email,
      password: pass
    });
    promise.catch(e => console.log(e.message)); //.then(user => console.log(user))
    });
  
    btnLogout.addEventListener('click', e => {
      firebase.auth().signOut();
    });
  
    //add a realtime listener
    firebase.auth().onAuthStateChanged(firebaseUser =>{
      if (firebaseUser){
        console.log(firebaseUser);
        btnLogout.classList.remove('hide');
      
        var user = firebase.auth().currentUser;

        user.sendEmailVerification().then(function() {
        // Email sent.
        }).catch(function(error) {
        // An error happened.
        });
      
      }else {
        console.log('not logged in');
        btnLogout.classList.add('hide');
      }
    });    
   } 
   else {         
    alert ("Sorry but registration has failed. Please check the information you have entered.");
  }                 
} 

	
	//const auth = firebase.auth();
	//auth.signInWithEmailAndPassword(email,pass);
	//auth.createUserWithEmailAndPassword(email,pass);
	//auth.onAuthStateChanged(firebaseUser => { });
	//https://www.youtube.com/watch?v=-OKrloDzGpU
	
  </script>
</body>
</html>